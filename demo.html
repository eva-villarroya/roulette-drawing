<html>
	<header>
	<!-- 
	This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
	-->
		<script src="javascripts/raphael.js"></script>
		 <style type="text/css">  
            #canvas_container {  
                width: 500px;
                height: 500px;  
                border: 0px solid #000;
                float: left;  
            }  
            #cockpit {  
                width: 500px;
                height: 500px;  
                border: 1px solid #000;
                float: left;   
            } 
        </style>
	<header>
	<body>
		<div id="cockpit">Cockpit</div>
		<div id="canvas_container"></div>
		
		<script type="text/javascript">
			var CurveDrawer = 
			{
				canvasSize : 500,			
				canvasColor : '#F0F',
				
				// amplification of view
				zoom : 150,

				// radius of static circle
				staticCircleRadius : 1,
				// radius of moving circle 
				movingCircleRadius : 10/13,
				// distance from radius of moving circle of drawing point
				distanceDrawingTip : 11/13,
			
				// spin step size of moving circle
				rotation : 2.5,
			
				// shorthand
				angleTransformation :  Math.PI / 200,
			
				//colors
				red : 0,
				green : 0,
				blue : 0,
				// width of line
				strokeWidth : 1,

			    paper : Raphael("canvas_container", this.canvasSize, this.canvasSize),
	
				R : function() {
					return this.staticCircleRadius * this.zoom;
				},
			
				r : function() {
					return this.movingCircleRadius * this.zoom;
				},
			
				d: function() {
					return this.distanceDrawingTip * this.zoom;
				},
				
				centerCanvas: function(){
					return this.canvasSize / 2;
				},
				
				calculatePoint :function (angle){
					var circlesDistance = this.R() - this.r();
			    	var calculatedAngle = angle * this.angleTransformation;
					var tmpCalc = (circlesDistance/this.r()) * calculatedAngle;
				
					var pointX = circlesDistance * Math.cos(calculatedAngle) + this.d() * Math.cos(tmpCalc);
					var pointY = circlesDistance * Math.sin(calculatedAngle) - this.d() * Math.sin(tmpCalc);

					return [parseFloat(pointX.toFixed(2)), parseFloat(pointY.toFixed(2))];				
				},
			
				drawLine: function (x, y, nextX, nextY, color){
			    	var line = this.paper.path( ["M", x + this.centerCanvas(), y + this.centerCanvas(), 
			    		"L", nextX + this.centerCanvas(), nextY + this.centerCanvas()]);
			    	line.attr ("stroke", color);
			    	line.attr("stroke-width", this.strokeWidth);
				},
			
				colorRainbow: function (angle) {
					this.blue = (angle * 2) % 255;
					this.green = (angle * 2) % 510;
				
					if(this.green > 254) {
						this.green = 510 - this.green;
					}
				
					this.red = (angle * 4) % 255;
				},
			
				greyscaleDegradation: function (angle){
					this.blue = angle % 510;
						
					if(this.blue > 254) {
						this.blue = 510 - this.blue;
					}
					
					this.green = angle % 510;
						
					if(this.green > 254) {
						this.green = 510 - this.green;
					}
						
					this.red = angle % 510;
						
					if(this.red > 254) {
						this.red = 510 - this.red;
					}
				},
			
				funColors: function (angle) {
					var module = 420;	
					var color = angle % module;
				
					if(color > (module / 2)) {
						color = (module - color);
					}
				
					return color;
				},
			
				colorDegradation: function (angle, skipColor){
					var color = this.funColors(angle);
				
					if(skipColor != "blue") {
						this.blue = color;
					}
				
					if(skipColor != "green") {	
						this.green = color;	
					}
				
					if(skipColor != "red") {			
						this.red = color;
					}
				},
				
				draw: function (){
					this.paper.canvas.style.backgroundColor = this.canvasColor;
					
					var firstPoint = this.calculatePoint(0);
					var lastPoint = firstPoint;
					var angle = this.rotation;
					var keepOnDrawing = true;
					
					//this.blue = 154; //1
					//this.green = 75; //1
					
					do {
						var currentPoint = this.calculatePoint(angle);
						
						//this.red = this.funColors(angle); //1
						
						//this.colorDegradation(angle, "green"); // 2
						
						//this.greyscaleDegradation(angle); // 3
						
						// this.colorRainbow(angle); // 4
					
						var color = "rgb(" + this.red + ", " + this.green + ", " + this.blue + ")";
					
						this.drawLine(lastPoint[0], lastPoint[1], currentPoint[0], currentPoint[1], color);
										
						keepOnDrawing = (currentPoint[0] != firstPoint[0]) || (currentPoint[1] != firstPoint[1]);
					
						if(keepOnDrawing) {						
							angle = angle + this.rotation;
							lastPoint = currentPoint;
						}
					} while(keepOnDrawing);	
				}				
			};
		
			CurveDrawer.draw();
		</script>
	</body>
</html>